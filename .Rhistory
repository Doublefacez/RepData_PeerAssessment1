summarise(sum = sum(steps, na.rm = TRUE))
data_fill_sum
hist(data_fill_sum)
hist(data_fill_sum$sum)
hist(data_fill_sum$date)
#Question 2 Histogram of the total number of steps taken each day
total_step <- data %>%
group_by(date)%>%
summarise(sum_each_day = sum(steps, na.rm=TRUE))
hist(total_step$sum_each_day, xlab = "Total number of steps each day", main = "Histogram of steps perday")
total_day <- filter(data_fill_sum, na < 1)
total_day <- filter(data_fill_sum, steps < 1)
data_fill_sum
total_day <- filter(data_fill, steps < 1)
hist(data_fill$date)
hist(data_fill$steps)
data_fill_sum <- data_fill%>%
group_by(date)%>%
summarise(sum = sum(steps))
data_fill_sum
hist(data_fill_sum$steps)
hist(data_fill_sum$sum)
data_fill_sum2 <- data_fill%>%
group_by(date)%>%
summarise(sum = sum(steps, na.rm = TRUE))
data_fill_sum2
hist(data_fill_sum2$sum)
hist(data_fill_sum$sum, xlab = "Total number of steps each day",
main = "Historgram of total number of steps each day")
mean(data_fill_sum)
mean(data_fill_sum$sum)
hist(data_fill_sum$sum, xlab = "Total number of steps each day",
main = "Historgram of total number of steps each day", binwidth = 2000)
hist(data_fill_sum$sum, xlab = "Total number of steps each day",
main = "Historgram of total number of steps each day", breaks = 8)
hist(data_fill_sum$sum, xlab = "Total number of steps each day",
main = "Historgram of total number of steps each day", breaks = 6)
hist(data_fill_sum$sum, xlab = "Total number of steps each day",
main = "Historgram of total number of steps each day", breaks = 7)
hist(data_fill_sum$sum, xlab = "Total number of steps each day",
main = "Historgram of total number of steps each day", breaks = 10)
mean(data_fill_sum$sum)
median(data_fill_sum$sum)
mean(data_fill_sum$sum, na.rm = TRUE)
median(data_fill_sum$sum, na.rm = TRUE)
mean_fill_step <- mean(data_fill_sum$sum, na.rm = TRUE)
median_fill_step <- median(data_fill_sum$sum, na.rm = TRUE)
mean_dif <- mean_fill_step - mean_t_step
mean_dif
median_dif <- median_fill_step - median_t_step
median_dif
data_fill
weekdays(data_fill$date)
weekdays(data_fill$date[1])
as.Date(data_fill)
as.Date(data_fill$date)
weekdays(data_fill)
weekdays(data_fill$date)
as.Date(as.character(data_fill$date))
weekdays(data_fill$date)
class(data_fill$date)
a  <- ymd(data_fill$date)
a
weekdays(a)
data_fill_date <- data_fill
data_fill_date$date <- ymd(data_fill_date$date)
data_fill_date
data_fill_date$date <- weekdays(ymd(data_fill_date$date))
data_fill_date
weekday <- filter(data_fill_date, date == c("Monday", "Tuesday", "Wednesday"))
weekday
weekday <- filter(data_fill_date, date == "Monday" |"Tuesday" |"Wednesday"))
weekday <- filter(data_fill_date, date == Monday |Tuesday |Wednesday))
weekday <- filter(data_fill_date, date %in% c("Monday", "Tuesday", "Wednesday"))
data_fill_date
weekday <- filter(data_fill_date, date %in% c("Monday", "Tuesday"))
str(data_fill_date)
as.Date(weekday$date)
as.Date(data_fill_date$date)
as.Date(as.character(data_fill_date$date))
weekday <- filter(data_fill_date, date == "Monday")
data_fill_date
str(data_fill_date)
as.Date(as.character(data_fill_date$date))
as.Date(data_fill$date))
as.Date(data_fill$date)
data_fill_date <- data_fill
data_fill_date$date <- weekdays(ymd(data_fill_date$date))
data_fill_date
weekday <- filter(data_fill_date, date == "Monday")
weekday <- filter(data_fill_date, date == Monday)
weekday <- filter(data_fill_date, date == "Monday")
weekday
colnames(data_fill_date)
weekday <- data_fill_date%>%
filter(date == "Monday")
weekday <- data_fill_date %>%
filter(date == "Monday")
weekday <- data_fill_date %>%
filter(date == "Monday")
weekday <- data_fill_date %>%
filter(date == "Monday")
data_fill_date <- data_fill
data_fill_date$date <- weekdays(ymd(data_fill_date$date))
data_fill_date
weekday <- data_fill_date %>%
colnames(data_fill_date)
data_fill_sum <- data_fill%>%
group_by(date)%>%
summarise(sum = sum(steps))
data_fill_sum
# Week 2 Peer review assessment
library(dplyr)
#Question 1 Calculate the total number of steps taken per day
total_step <- sum(data$steps, na.rm = TRUE)
#Question 2 Histogram of the total number of steps taken each day
total_step <- data %>%
group_by(date)%>%
summarise(sum_each_day = sum(steps, na.rm=TRUE))
weekday <- data_fill_date %>%
colnames(data_fill_date)
weekday <- data_fill_date %>%
filter(date == "Monday")
weekday <- filter(data_fill_date, date == "Monday")
weeday
weekday
weekday <- filter(data_fill_date, date == c("Monday", "Tuesday")
weekday
weekday
View(weekday)
weekday <- filter(data_fill_date, date == c("Monday", "Tuesday")
weekday <- filter(data_fill_date, date == c("Monday", "Tuesday"))
weekday <- filter(data_fill_date, date == c("Monday", "Tuesday"))
weekday
weekday <- filter(data_fill_date, date == c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))
weekday <- filter(data_fill_date, date == c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))
weekday <- filter(data_fill_date, date == c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))
weekday
weekend <- filter(data_fill_date, date == c("Saturday", "Sunday"))
weekend
weekday1 <- mutate(data_fill_date, weekday = case_when(date == c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday") ~ "Weekday"))
weekday1
View(weekday1)
data_fill_date <- data_fill
data_fill_date$date <- weekdays(ymd(data_fill_date$date))
data_fill_date
weekday <- filter(data_fill_date, date == c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))
weekday1 <- mutate(data_fill_date, weekday = case_when(date == c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday") ~ "Weekday"))
View(weekday1)
View(weekday1)
wday(data_fill_date)
wday(data_fill_date$date)
a <- data_fill$date
a <- ymd(data_fill$date)
a
wday(a)
View(a)
sum(a == 7)
sum(a==1)
sum(a <1)
sum(a = 1:6)
data_fill_date$date <- wday(ymd(data_fill_date$date))
data_fill_date <- data_fill
data_fill_date$date <- wday(ymd(data_fill_date$date))
data_fill_date
weekday1 <- mutate(data_fill_date, weekday = 2:6 ~ "Weekday"))
weekday1 <- mutate(data_fill_date, weekday == 2:6 ~ "Weekday"))
weekday1 <- mutate(data_fill_date, weekday == 2:6 ~ "Weekday")
weekday1 <- mutate(data_fill_date, weekday = 2:6 ~ "Weekday")
weekday1 <- mutate(data_fill_date, weekday %in% 2:6 ~ "Weekday")
weekday1 <- mutate(data_fill_date, weekday = case_when(date) %in% 2:6 ~ "Weekday")
data_fill_date
weekday1 <- mutate(data_fill_date, weekday = case_when(date) %in% 2:6 ~ "Weekday")
weekday1
weekend <- filter(data_fill_date, date == c("Saturday", "Sunday"))
weekend
data_fill_date <- data_fill
day <- data_fill_date %>%
mutate(
date = ymd(date),
day = case_when(wday(date)%in% 2:6 ~ "Weekday")
)
day
a <- data_fill
a$date <- ymd(a$date)
a
str(a)
ymd(a$date)
wday(a$date)
b <- wday(a$date)
a$date <- wday(ymd(a$date))
a
c <- mutate(a, day = case_when(date) %in% 2:6 ~ "Weekday")
c <- mutate(a, day = case_when(a$date) %in% 2:6 ~ "Weekday")
c <- mutate(a, day = case_when(a$date) = 2 ~ "Weekday")
c <- mutate(a, day = case_when(a) = 2 ~ "Weekday")
c <- mutate(a, day = case_when(date) %in% 2 ~ "Weekday")
c <- mutate(a, Day = case_when(date) %in% 2 ~ "Weekday")
c <- a %>%
mutate(day = case_when(date)%in% 2:6 ~ "Weekday")
c <- a %>%
mutate(day = case_when(date)%in% 2:6 ~ "Weekday")
mutate(date = ymd(date),
c <- a %>%
mutate(date = ymd(date),
c
c <- a %>%
mutate(date = ymd(date),
day = case_when(wday(date)%in% 2:6 ~ "Weekday"))
day <- data_fill_date %>%
mutate(
date = ymd(date),
day = case_when(wday(date)%in% 2:6 ~ "Weekday")
)
day
str(day)
a
str(a)
str(day)
str(data_fill_date)
a$date <- ymd(a$date)
str(a)
a <- data_fill
a$date <- ymd(a$date)
str(a)
a$date <- wday(a$date)
a
str(a)
c <- a%>%
mutate(day = case_when(date) %in% 2:6 ~ "Weekday")
c <- a%>%
mutate(day = case_when(date)= 2:6 ~ "Weekday")
c <- a%>%
mutate(day = case_when(date)%in% 2:6 ~ "Weekday")
c <- mutate(a, day = case_when(date)%in% 2:6 ~ "Weekday")
c <- mutate(a, jj = case_when(date)%in% 2:6 ~ "Weekday")
df <- data_fill
df
df <- df %>% mutate(day_of_week = wday(date, label = TRUE))
df
str(df)
df <- df %>% mutate(day_of_week = wday(date))
df
library(lubridate)
df <- df %>% mutate(day_of_week = wday(date))
str(df)
df <- df %>% mutate(day_of_week = case_when(wday(date)) %in% 2:6 ~"weekday")
df <- df %>% mutate(day_of_week = wday(date))
df
df1 <- df %>%
mutate(day_of_week = replace(day_of_week, day_of_week= 2:6))
df1 <- df %>%
mutate(day_of_week = replace(day_of_week, day_of_week= 2))
df1 <- df %>%
mutate(day_of_week = replace(day_of_week, day_of_week== 2, "Weekday"))
df1
df1 <- df %>%
mutate(day_of_week1 = replace(day_of_week, day_of_week== 2, "Weekday"))
df1
str(df)
df2 <- df %>% mutate(a = wday(date), a = replace(a, a ==2, "weekday"))
df2
df <- data_fill
df2 <- df %>% mutate(a = wday(date), a = replace(a, a ==2, "weekday"))
df2
df2 <- df %>% mutate(a = wday(date), a = replace(a, a ==2:6, "weekday"))
df2
df2 <- df %>% mutate(a = wday(date), a = replace(a, a ==2|3|4|5|6, "weekday"))
df2
a <- wday(data_fill$date)
a
data_fill_date <- data_fill
data_fill_date$date <- wday(ymd(data_fill_date$date))
data_fill_date
day_of_week <- data_fill_date %>%
mutate(day = replace(day, date == 2|3|4|5|6, "weekday"))
day_of_week <- data_fill_date %>%
mutate(day = replace(date, date == 2|3|4|5|6, "weekday"))
day_of_week
day_of_week <- data_fill_date %>%
mutate(day = replace(date, date == 2|3|4|5|6~ "weekday", date))
day_of_week <- data_fill_date %>%
mutate(day = replace(date, date == 2|3|4|5|6~ "weekday"))
day_of_week <- data_fill_date %>%
mutate(day = replace(date, date == 2|3|4|5|6 ~ "weekday"))
day_of_week <- data_fill_date %>%
mutate(day = replace(date, date == 2|3|4|5|6 ~ "weekday"))
day_of_week <- data_fill_date %>%
mutate(day = replace(date, date == 2|3|4|5|6, "weekday", date == 1|7, "weekend"))
mutate(day = replace(date, date == 1|7, "weekend")
day_of_week <- data_fill_date %>%
day_of_week <- data_fill_date %>%
mutate(day = replace(date, date == 2|3|4|5|6, "weekday"))%>%
mutate(day = replace(date, date == 1|7, "weekend"))
day_of_week
day_of_week <- data_fill_date %>%
mutate(day = replace(date, date == 2|3|4|5|6, "weekday"))%>%
mutate(day = replace(date, date == 1, "weekend"))
day_of_week
day_of_week <- data_fill_date %>%
mutate(day = replace(date, date == 2|3|4|5|6, "weekday"))%>%
mutate(day = replace(date, date == 1, "weekend"))
day_of_week
day_of_week <- data_fill_date %>%
mutate(day = replace(date, date == 2|3|4|5|6, "weekday"))
day_of_week
View(weekday)
View(day_of_week)
weekday <- filter(data_fill_date, date == c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))
weekday1 <- mutate(data_fill_date, weekday = case_when(date) %in% 2:6 ~ "Weekday")
weekday
data_fill_date <- data_fill
data_fill_date
data_fill_date$date <- weekdays(data_fill_date$date)
data_fill_date$date <- weekdays(as.Date(data_fill_date$date)
data_fill_date$date <- weekdays(as.Date(data_fill_date$date))
data_fill_date
str(data_fill_date)
data_fill_date$date <- weekdays(as.Date(as.character(data_fill_date$date)))
str(data_fill_date)
weekday <- filter(data_fill_date, date == c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))
weekday
weekday1 <- mutate(data_fill_date, weekday = replace(date, date = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"), "Weekday"))
weekday1
weekday1 <- mutate(data_fill_date, weekday = replace(date, date = "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Weekday"))
weekday1 <- mutate(data_fill_date, weekday = replace(date, date = "Monday", "Weekday"))
data_fill_date
str(data_fill_date)
weekday1 <- mutate(data_fill_date, weekday = replace(date, date , "Weekday"))
weekday1 <- mutate(data_fill_date, weekday = replace(date, date, "Weekday"))
weekday1
weekday1 <- mutate(data_fill_date, weekday = replace(date, date = "Monday"| "Tuesday"| "Wednesday"| "Thursday"| "Friday", "Weekday"))
df2 <- df %>% mutate(a = wday(date), a = replace(a, case_when(a, a ==2|3|4|5|6~ "weekday"))
df2
df2 <- df %>% mutate(a = wday(date), a = replace(a, case_when(a, a ==2:^~ "weekday"))
df2 <- df %>% mutate(a = wday(date), a = replace(a, case_when(a, a ==2:6~ "weekday"))
df2
df2 <- df %>% mutate(a = wday(date), a = replace(a, case_when(a %in% 2:6~ "weekday"))
str(d
df2 <- df %>% mutate(a = wday(date), a = replace(a, case_when(a %in% 2:6~ "weekday", a%in% c(1,7)~ "Weekend"))
str(d
df2
View(df2)
df2 <- df %>% mutate(a = wday(date), a = replace(a, case_when(a %in% 2:6 ~ "weekday", a%in% c(1,7)~ "Weekend"))
df2
day <- data_fill_date %>%
mutate(
date = ymd(date),
day = case_when(wday(date)%in% 2:6 ~ "Weekday",
wday(date) %in% c(1,7) ~ "Weekend")
)
day
data_fill_date <- data_fill
day <- data_fill_date %>%
mutate(
date = ymd(date),
day = case_when(wday(date)%in% 2:6 ~ "Weekday",
wday(date) %in% c(1,7) ~ "Weekend")
)
day
View(day)
colnames(day)
mean_by_day <- day%>%
group_by(interval, day)%>%
summarise(steps = mean(steps))
mean_by_day
library(ggplot2)
ggplot(mean_by_day, aes(x = interval, y = steps))+
facet_grid(day~.)+
geom_line()
ggplot(mean_by_day, aes(x = interval, y = steps))+
facet_wrap(day~.)+
geom_line()
ggplot(mean_by_day, aes(x = interval, y = steps))+
facet_wrap(.~day)+
geom_line()
ggplot(mean_by_day, aes(x = interval, y = steps))+
facet_wrap(~day)+
geom_line()
ggplot(mean_by_day, aes(x = interval, y = steps))+
facet_wrap(~day, nrow = 2)+
geom_line()
ggplot(mean_by_day, aes(x = interval, y = steps))+
facet_wrap(day.~, nrow = 2)+
geom_line()
ggplot(mean_by_day, aes(x = interval, y = steps))+
facet_wrap(day.~, nrow = 2)+
geom_line()
ggplot(mean_by_day, aes(x = interval, y = steps))+
facet_wrap(day, nrow = 2)+
geom_line()
ggplot(mean_by_day, aes(x = interval, y = steps))+
facet_wrap(day, nrow = 2)+
geom_line()
ggplot(mean_by_day, aes(x = interval, y = steps))+
facet_wrap(~day, nrow = 2)+
geom_line()
ggplot(mean_by_day, aes(x = interval, y = steps))+
facet_wrap(day~, nrow = 2)+
geom_line()
ggplot(mean_by_day, aes(x = interval, y = steps))+
facet_wrap(~day, nrow = 2)+
geom_line()
ggplot(mean_by_day, aes(x = interval, y = steps), xlab = "t minutes interval")+
facet_wrap(~day, nrow = 2)+
geom_line()
ggplot(mean_by_day, aes(x = interval, y = steps))+
labs(x = "Time (5 mins interval", y = "Average number of steps")
ggplot(mean_by_day, aes(x = interval, y = steps))+
labs(x = "Time (5 mins interval", y = "Average number of steps")+
facet_wrap(~day, nrow = 2)+
geom_line()
ggplot(mean_by_day, aes(x = interval, y = steps))+
labs(x = "Time (5 mins intervals)", y = "Average number of steps",
title = "Average number of steps every 5 mins on weekday and weekend")+
facet_wrap(~day, nrow = 2)+
geom_line()
ggplot(mean_by_day, aes(x = interval, y = steps))+
labs(x = "Time (5 mins intervals)", y = "Average number of steps",
title = "Average number of steps every 5 mins on weekday and weekend")+
theme(legend.title.align = 0.5)
ggplot(mean_by_day, aes(x = interval, y = steps))+
labs(x = "Time (5 mins intervals)", y = "Average number of steps",
title = "Average number of steps every 5 mins on weekday and weekend")+
theme(legend.title.align = 0.5)+
facet_wrap(~day, nrow = 2)+
geom_line()
ggplot(mean_by_day, aes(x = interval, y = steps))+
labs(x = "Time (5 mins intervals)", y = "Average number of steps",
title = "Average number of steps every 5 mins on weekday and weekend")+
theme(legend.title.align = 0.5)+
facet_wrap(~day, nrow = 2)+
geom_line()
ggplot(mean_by_day, aes(x = interval, y = steps))+
labs(x = "Time (5 mins intervals)", y = "Average number of steps",
title = "Average number of steps every 5 mins on weekday and weekend")+
theme(title = 0.5)+
facet_wrap(~day, nrow = 2)+
geom_line()
ggplot(mean_by_day, aes(x = interval, y = steps))+
labs(x = "Time (5 mins intervals)", y = "Average number of steps",
title = "Average number of steps every 5 mins on weekday and weekend")+
theme(title = 0.5)+
facet_wrap(~day, nrow = 2)+
geom_line()
ggplot(mean_by_day, aes(x = interval, y = steps))+
labs(x = "Time (5 mins intervals)", y = "Average number of steps",
title = "Average number of steps every 5 mins on weekday and weekend")+
theme(legend.title =  = 0.5)+
facet_wrap(~day, nrow = 2)+
geom_line()
ggplot(mean_by_day, aes(x = interval, y = steps))+
labs(x = "Time (5 mins intervals)", y = "Average number of steps",
title = "Average number of steps every 5 mins on weekday and weekend")+
theme(plot.title = element_text(hjust = 0.5))+
facet_wrap(~day, nrow = 2)+
geom_line()
#Question 1 Calculate the total number of steps taken per day
total_step <- sum(data$steps, na.rm = TRUE)
#Question 2 Histogram of the total number of steps taken each day
total_step <- data %>%
group_by(date)%>%
summarise(sum_each_day = sum(steps, na.rm=TRUE))
hist(total_step$sum_each_day, xlab = "Total number of steps each day", main = "Histogram of steps perday")
clean <- filter(data, !is.na(steps))
clean
tidy <- aggregate(steps~interval, clean, mean)
tidy
plot(tidy$interval, tidy$steps, type = "l", xlab = "Time", ylab = "Steps", main = "Average steps per time interval")
#Question 5
str(tidy)
tidy2<- tidy%>%
rename(Time_interval = interval)
max_step <- filter(tidy, steps==max(steps))
max_step
miss <- sum(is.na(data))
miss
data_fill <- data %>%
mutate(steps = case_when(is.na(steps) ~ tidy$steps[match(
data$interval, tidy$interval)], TRUE ~ as.numeric(steps)
))
data_fill
data_fill_sum <- data_fill%>%
group_by(date)%>%
summarise(sum = sum(steps))
data_fill_sum
hist(data_fill_sum$sum, xlab = "Total number of steps each day",
main = "Historgram of total number of steps each day", breaks = 10)
mean_fill_step <- mean(data_fill_sum$sum, na.rm = TRUE)
median_fill_step <- median(data_fill_sum$sum, na.rm = TRUE)
mean_dif <- mean_fill_step - mean_t_step
mean_dif
median_dif <- median_fill_step - median_t_step
median_dif
data_fill_date <- data_fill
data_fill_date$date <- wday(ymd(data_fill_date$date))
day <- data_fill_date %>%
mutate(date = ymd(date),
day = case_when(wday(date)%in% 2:6 ~ "Weekday",
wday(date) %in% c(1,7) ~ "Weekend")
)
colnames(day)
mean_by_day <- day%>%
group_by(interval, day)%>%
summarise(steps = mean(steps))
mean_by_day
ggplot(mean_by_day, aes(x = interval, y = steps))+
labs(x = "Time (5 mins intervals)", y = "Average number of steps",
title = "Average number of steps every 5 mins on weekday and weekend")+
theme(plot.title = element_text(hjust = 0.5))+
facet_wrap(~day, nrow = 2)+
geom_line()
